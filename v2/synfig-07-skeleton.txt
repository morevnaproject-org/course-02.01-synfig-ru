==== Скелет ====
Итак, в предыдущих уроках мы рассмотрели один простой способ сделать анимацию персонажа. 

Но его главная проблема в том, что управлять таким персонажем не очень удобно  - каждый раз приходится сначала выделять нужную часть и уже только после этого двигать, кроме того нужно постоянно придумывать как правильно группировать объекты. Если у нас более сложный персонаж, то нам придётся создавать много групп и постоянно переключаться между ними во время анимации. 

Это не очень удобно и поэтому для анимации персонажей и других сложных структур часто пользуются костями. 

С помощью костей вы можете создать вот такой скелет и легко управлять всеми частями персонажа. Очень просто. 

Итак, сейчас я покажу вам как собрать такую марионетку с самого начала.

Давайте откроем папку «character-2». Здесь у нас лежит изображение персонажа целиком и все части.

Чтобы нам было проще собирать персонажа, давайте сначала импортируем целую картинку. А теперь вставим все остальные части. 

Готово. Сгруппируем всё вместе и уменьшим, чтобы перонаж поместился на рабочей области.

Теперь давайте разберем образовавшийся завал из конечностей. 

== Параметр прозрачности слоя ==
Чтобы нам было удобнее, давайте сделаем картинку с целым персонажем полупрозрачной. Для этого отредактируем параметр «Величина» (Amount) который отвечает за прозрачность слоя. Поставим значение 0,5.

Теперь расставим все части на места. Ставим туловище, голову. Теперь ноги - верхняя часть, нижняя и ступня. Вторая нога оказалась поверх туловища это легко исправить. Просто перемещаем ее вниз. И по аналогии собираем остальные части. 

Согласитесь это довольно увлекательно, чем-то похоже на пазл. 

Ну и не забывайте почаще сохраняться!

Готово. Этот слой нам больше не нужен, лучше его скрыть.

== Слой скелета ==
А теперь добавим слой скелета. Этот слой должен находиться внутри группы, поверх всех частей персонажа, поэтому, здесь выделяем первый слой, щёлкаем по нему правой кнопкой мыши, выбираем «Создать слой» (New Layer) - «Прочие» (Other) - «Скелет» (Skeleton).

Вот, появился слой скелета, в котором уже есть одна кость. Вот она. Зелёная точка — это основание кости. А коричневая определяет её угол и длину. 

== Добавление костей ==
Давайте создадим ещё одну кость, которая будет подчиняться той, которая у нас уже есть. Щелкнем правой кнопкой по любой точке этой кости и выбираем «Создать дочернюю кость» (Create child bone).

== Иерархия костей ==
Вот, появилась вторая кость. Первая кость является главной по отношению к ней. Смотрите, когда я двигаю первую кость, то она тянет за собой вторую. Но при этом вторая может двигаться сама по себе. Так работает иерархия костей.

== Структура костей персонажа ==
Итак, давайте установим первую кость. Она будет отвечать за положение всего персонажа.

Вторая кость отвечает за туловище — ставим её сюда. 

Руки и голова будут подчиняться туловищу, создадим кости для них из этой кости. Щёлкаем на ней правой кнопкой, вбираем «Создать дочернюю кость» (Create child bone). Теперь из этой кости мы создаем кость для нижней части руки, и из неё кость для ладони.  То же самое и для второй руки.

Кости для ног создаем из первой, так как при наклоне туловища ноги должны оставаться на месте. Далее создаем кость для нижней части ноги и для ступни. И для второй ноги делаем кости по анологии.

== Привязка к костям ==
Ну вот, скелет готов. Пока что он никак не влияет на части и двигается сам по себе.

Нам нужно привязать все части к скелету.

Чтобы привязать туловище, нам нужно выделить его слой и сам скелет. Щёлкаем на туловище, потом удерживая CTRL щёлкаем на слой скелета (в списке слоёв). Теперь щелчком левой кнопкой мыши выделяем зелёную точку у группы. Так мы указываем программе что именно хотим привязать. А теперь укажем куда привязывать - правой кнопкой нажимаем на кость и выбираем «Привязать к кости» (Link to bone). Ну вот все работает, туловище привязано. 

Таким же образом привязываем остальные части к скелету. 

Если  мы случайно привяжем какую-то часть не к той кости, то просто привяжите её к другой, - она отвяжется от предыдущей автоматически.

== Управление костями ==
Итак, персонаж готов, попробуем подвигать его.

Обратите внимание, что когда я тяну за кончик кости, то кость автоматически растягивает изображение в нужном направлении. Это очень удобно. Хотя, бывают случаи, когда это не совсем желательно. Например, в случае с головой. Если мы хотим наклонить её, то нам совсем не нужно чтобы она растягивалась. Именно для этого каждая кость имеет вот эту синюю точку. Она позволяет менять угол кости, не меняя её длины. Вот так.

== Менять части после привязки ==
После того как вы привязали слой к кости это не значит что мы должны его двигать только костями. Нет, мы можем двигать его самостоятельно, просто он будет двигаться относительно той кости, к которой привязан. Это очень удобно во время анимации,если нам вдруг нужно что-то подправить. Главное не запутаться! 

== Скелет и система координат ==
И, наконец, ещё одно очень важное замечание.
Все части нашего персонажа располагаются внутри группы, которую мы уменьшили в самом начале. Когда я создавал слой скелета, то я поместил его внутрь этой группы. Это очень важно, потому что скелет и части, которые мы привязываем, должны находиться в одной системе координат.

Если мы будем создавать скелет за пределами группы, то координаты костей не будут совпадать с координатами объектов. Когда вы будете привязывать вы ничего не заметите, но вот когда попробуете изменить положение костей — вот тут и начнутся чудеса.

Давайте сохраним и закроем этот файл и я вам покажу пример по этому поводу.

Вот, давайте соберём нашего персонажа, но возьмём только туловище, голову и одну руку. 

Предположим мы захотели собрать руку вот таким образом — собрали её вот тут, потом сгруппировали, переместили, да ещё и повернули. Как вы понимаете, после этого все части руки будут находиться в другой системе координат, так как мы их трансформировали.

Попробуем создать скелет.

Вот так, привязали туловище, голову и части руки. 

Теперь пробуем изменить позу. Как видите, с головой и туловищем всё в порядке, а вот с руками происходит что-то невообразимое. Это всё из-за трансформированной группы.

Если бы группа не была трансформирована, то всё было бы в порядке — она бы нам не мешала.

Чтобы исправить ситуацию нужно вытащить части из группы и подогнать их к скелету заново.

Но мы сейчас сделаем по-другому. Предположим, что нам не нужно чтобы персонаж сгибал руку в локте и запястье. Тогда нам для руки достаточно одной кости и мы можем привязать к ней всю группу. 

== Структура слоя изображения ==
Да, именно так - мы можем привязывать к скелету не только слои изображений, но и группы. Хотя, вы наверное уже догадались, что слой изображения это на самом деле тоже группа (точнее — группа-переключатель). А сам слой изображения находится внутри. Но, не будем отвлекаться.

== Отвязывание от костей ==
Сначала давайте отвяжем части внутри группы от скелета.  Выделим нужную часть, находим параметр «Трансформация» (Transformation), щёлкаем правой кнопкой и выбираем «Отсоединить» (Disconnect). 

Да-да, мы точно так же удаляли анимацию, не обращайте внимания.

А теперь привяжем группу. Вот так, готово.

Ну, на этом всё. В следующем уроке мы  попробуем санимировать скелет.
